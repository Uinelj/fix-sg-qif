<!DOCTYPE html>
<html>

<head>
  <title>File Reader and Processor Example</title>
  <!-- Import Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.15/dist/tailwind.min.css" rel="stylesheet" />
</head>

<body class="bg-gray-200 py-8">
  <div class="max-w-md mx-auto bg-white p-8 rounded-md shadow-md">
    <h1 class="text-xl font-bold mb-4">File Reader and Processor Example</h1>
    <label for="file-input" class="block mb-4">
      <span class="text-gray-700 font-bold mb-2">Choose a file to process:</span>
      <input type="file" id="file-input" class="py-2 px-4 rounded-md border-gray-400 w-full" />
    </label>
    <button id="download-btn" disabled
      class="py-2 px-4 rounded-md bg-blue-600 text-white font-bold hover:bg-blue-700 focus:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed">
      Download
    </button>
  </div>

  <script>
    const fileInput = document.getElementById("file-input");
    const downloadBtn = document.getElementById("download-btn");

    function processFile(file) {
      const reader = new FileReader();
      reader.onload = () => {
        let content = reader.result;

        // Process the file contents
        if (content.startsWith("!type")) {
          content = content.replace("t", "T", 1);
        }

        // Enable the download button
        downloadBtn.disabled = false;
        downloadBtn.addEventListener("click", () => {
          const blob = new Blob([content], { type: "text/plain" });
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = file.name;
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
        });
      };

      reader.readAsText(file, "iso-8859-1");
    }

    fileInput.addEventListener("change", () => {
      const file = fileInput.files[0];
      processFile(file);
    });
  </script>
</body>

</html>
